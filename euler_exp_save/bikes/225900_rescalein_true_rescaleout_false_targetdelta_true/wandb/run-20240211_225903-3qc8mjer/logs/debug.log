2024-02-11 22:59:03,966 INFO    MainThread:81363 [wandb_setup.py:_flush():76] Current SDK version is 0.15.11
2024-02-11 22:59:03,966 INFO    MainThread:81363 [wandb_setup.py:_flush():76] Configure stats pid to 81363
2024-02-11 22:59:03,966 INFO    MainThread:81363 [wandb_setup.py:_flush():76] Loading settings from /cluster/home/tvannier/.config/wandb/settings
2024-02-11 22:59:03,966 INFO    MainThread:81363 [wandb_setup.py:_flush():76] Loading settings from /cluster/home/tvannier/HUCRL_for_FMDP/exp/wandb/bikes/pets_adapted/2024.02.11/225900_rescalein_true_rescaleout_false_targetdelta_true/wandb/settings
2024-02-11 22:59:03,966 INFO    MainThread:81363 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2024-02-11 22:59:03,966 INFO    MainThread:81363 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-02-11 22:59:03,967 INFO    MainThread:81363 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'run_scripts/train.py', 'program_abspath': '/cluster/home/tvannier/HUCRL_for_FMDP/run_scripts/train.py', 'program': '/cluster/home/tvannier/HUCRL_for_FMDP/run_scripts/train.py'}
2024-02-11 22:59:03,967 INFO    MainThread:81363 [wandb_init.py:_log_setup():528] Logging user logs to /cluster/home/tvannier/HUCRL_for_FMDP/exp/wandb/bikes/pets_adapted/2024.02.11/225900_rescalein_true_rescaleout_false_targetdelta_true/wandb/run-20240211_225903-3qc8mjer/logs/debug.log
2024-02-11 22:59:03,967 INFO    MainThread:81363 [wandb_init.py:_log_setup():529] Logging internal logs to /cluster/home/tvannier/HUCRL_for_FMDP/exp/wandb/bikes/pets_adapted/2024.02.11/225900_rescalein_true_rescaleout_false_targetdelta_true/wandb/run-20240211_225903-3qc8mjer/logs/debug-internal.log
2024-02-11 22:59:03,967 INFO    MainThread:81363 [wandb_init.py:init():568] calling init triggers
2024-02-11 22:59:03,967 INFO    MainThread:81363 [wandb_init.py:init():575] wandb.init called with sweep_config: {}
config: {'seed': 0, 'device': 'cpu', 'log_frequency_agent': 1000, 'save_video': False, 'debug_mode': False, 'experiment_dir': 'wandb', 'root_dir': './exp', 'algorithm': {'name': 'pets_adapted', 'agent': {'_target_': 'mbrl.planning.TrajectoryOptimizerAgent', 'action_lb': '???', 'action_ub': '???', 'planning_horizon': 4, 'optimizer_cfg': {'_target_': 'mbrl.planning.CEMOptimizer', 'num_iterations': 20, 'elite_ratio': 0.1, 'population_size': 350, 'alpha': 0.1, 'lower_bound': '???', 'upper_bound': '???', 'return_mean_elites': True, 'device': 'cpu', 'clipped_normal': False}, 'replan_freq': 1, 'verbose': False}, 'normalize': False, 'rescale_input': True, 'rescale_output': False, 'normalize_double_precision': True, 'target_is_delta': True, 'initial_exploration_steps': 4, 'freq_train_model': 20, 'learned_rewards': True, 'dataset_size': 10000, 'num_particles': 20}, 'dynamics_model': {'model_trainer': {'_target_': 'src.util.model_trainer.ModelTrainerOverriden'}, 'model': {'_target_': 'src.model.gaussian_process.MultiOutputGP', 'device': 'cpu', 'in_size': '???', 'out_size': '???', 'mean': 'Linear', 'kernel': 'Matern', 'scale_kernel': True, 'reward_factors': None}, 'batch_size': 10000, 'model_lr': 0.05, 'model_wd': 0.0}, 'overrides': {'env': 'bikes', 'env_config': {'num_trucks': 2, 'action_per_day': 4, 'next_day_method': 'random', 'initial_distribution': 'zeros', 'bikes_per_truck': 7, 'fix_bikes_per_truck': True, 'start_walk_dist_max': 0.2, 'end_walk_dist_max': 1000.0, 'trip_duration': 0.5, 'past_trip_data': None, 'weather_data': None, 'n_hubs_per_rushhour': 1, 'n_edge_per_hub': 5, 'rushhour_std': 1.5, 'centroids_coord': 'src/env/bikes_data/20_centroids/20_centroids.npy', 'station_dependencies': 'src/env/bikes_data/20_centroids/factors_radius_2.npy'}, 'model_wrapper': {'_target_': 'src.model.dict_model_wrapper.OneDTransitionRewardModelDictSpace', 'model_input_obs_key': ['bike_allocations', 'time_counter'], 'model_input_act_key': [], 'model_output_key': ['bike_allocations']}, 'learned_rewards': True, 'trial_length': 4, 'initial_exploration_steps': 50, 'num_steps': 100000000, 'num_episodes': 10000, 'render_mode': None, 'model_path': None, 'model_batch_size': 256, 'validation_ratio': 0, 'freq_train_model': 20, 'patience': 10, 'num_epochs_train_model': 10, 'dataset_size': 10000, 'planning_horizon': 4, 'cem_num_iters': 20, 'cem_elite_ratio': 0.1, 'cem_population_size': 350, 'cem_alpha': 0.1, 'cem_clipped_normal': False}, 'action_optimizer': {'_target_': 'mbrl.planning.CEMOptimizer', 'num_iterations': 20, 'elite_ratio': 0.1, 'population_size': 350, 'alpha': 0.1, 'lower_bound': '???', 'upper_bound': '???', 'return_mean_elites': True, 'device': 'cpu', 'clipped_normal': False}, 'experiment': {'with_tracking': True, 'plot_local': False, 'api_name': 'wandb', 'run_configs': {'project': 'hucrl_fmdp', 'group': 'test_targetisdelta_art_4step_20centroid_784c36e594ae28f438c3ef5048ead0ffc87fd054', 'name': 'rescalein_true_rescaleout_false_targetdelta_true', 'settings': None, 'tags': None}}}
2024-02-11 22:59:03,967 INFO    MainThread:81363 [wandb_init.py:init():618] starting backend
2024-02-11 22:59:03,967 INFO    MainThread:81363 [wandb_init.py:init():622] setting up manager
2024-02-11 22:59:03,971 INFO    MainThread:81363 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-02-11 22:59:03,973 INFO    MainThread:81363 [wandb_init.py:init():628] backend started and connected
2024-02-11 22:59:03,982 INFO    MainThread:81363 [wandb_init.py:init():720] updated telemetry
2024-02-11 22:59:04,016 INFO    MainThread:81363 [wandb_init.py:init():753] communicating run to backend with 90.0 second timeout
2024-02-11 22:59:04,573 INFO    MainThread:81363 [wandb_run.py:_on_init():2220] communicating current version
2024-02-11 22:59:04,674 INFO    MainThread:81363 [wandb_run.py:_on_init():2229] got version response upgrade_message: "wandb version 0.16.3 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2024-02-11 22:59:04,675 INFO    MainThread:81363 [wandb_init.py:init():804] starting run threads in backend
2024-02-11 22:59:04,846 INFO    MainThread:81363 [wandb_run.py:_console_start():2199] atexit reg
2024-02-11 22:59:04,846 INFO    MainThread:81363 [wandb_run.py:_redirect():2054] redirect: wrap_raw
2024-02-11 22:59:04,847 INFO    MainThread:81363 [wandb_run.py:_redirect():2119] Wrapping output streams.
2024-02-11 22:59:04,847 INFO    MainThread:81363 [wandb_run.py:_redirect():2144] Redirects installed.
2024-02-11 22:59:04,849 INFO    MainThread:81363 [wandb_init.py:init():845] run started, returning control to user process
2024-02-11 23:00:41,155 WARNING MsgRouterThr:81363 [router.py:message_loop():77] message_loop has been closed
