-------------ENV INFO-------------
Observation space keys: KeysView(Dict('bike_allocations': Box(0.0, 56.0, (20,), float32), 'day': Box(1.0, 31.0, (1,), float32), 'day_of_week': Box(1.0, 7.0, (1,), float32), 'month': Box(1.0, 12.0, (1,), float32), 'time_counter': Box(1.0, 5.0, (1,), float32)))
Action space keys: KeysView(Dict('truck_centroid': Box(0.0, 19.0, (2,), float32)))
Using artificial rentals dynamics
Number of centroids: 20
Centroid induced dependencies file: src/env/bikes_data/20_centroids/factors_radius_2.npy
Results will be saved at /cluster/home/tvannier/HUCRL_for_FMDP/exp/wandb/bikes/pets_adapted/2024.02.11/225900_rescalein_true_rescaleout_false_targetdelta_true.
--------------MODEL INFO----------------
Model obs input keys: ['bike_allocations', 'time_counter']
Model action input keys: []
Model output keys: ['bike_allocations']
Rescale input: True
Rescale output: False
Target is delta: True
Learne rewards: True
Num elites: None
/cluster/home/tvannier/.local/lib/python3.9/site-packages/pygame/sysfont.py:228: UserWarning: Process running 'fc-list' timed-out! System fonts cannot be loaded on your platform
  warnings.warn(
| model_train    | I: 0 | E: 0 | TD: 50 | VD: 0 | MLOSS: 3.3707 | MVSCORE: 2.8560 | MBVSCORE: 2.8560 | TR2: -0.9057 | VR2: 0.2934
| model_train    | I: 0 | E: 1 | TD: 50 | VD: 0 | MLOSS: 3.2654 | MVSCORE: 2.7983 | MBVSCORE: 2.7983 | TR2: -0.7831 | VR2: 0.3073
| model_train    | I: 0 | E: 2 | TD: 50 | VD: 0 | MLOSS: 3.1668 | MVSCORE: 2.7398 | MBVSCORE: 2.7398 | TR2: -0.6741 | VR2: 0.3214
| model_train    | I: 0 | E: 3 | TD: 50 | VD: 0 | MLOSS: 3.0746 | MVSCORE: 2.6806 | MBVSCORE: 2.6806 | TR2: -0.5778 | VR2: 0.3357
| model_train    | I: 0 | E: 4 | TD: 50 | VD: 0 | MLOSS: 2.9885 | MVSCORE: 2.6208 | MBVSCORE: 2.6208 | TR2: -0.4945 | VR2: 0.3501
| model_train    | I: 0 | E: 5 | TD: 50 | VD: 0 | MLOSS: 2.9080 | MVSCORE: 2.5601 | MBVSCORE: 2.5601 | TR2: -0.4228 | VR2: 0.3647
| model_train    | I: 0 | E: 6 | TD: 50 | VD: 0 | MLOSS: 2.8330 | MVSCORE: 2.4988 | MBVSCORE: 2.4988 | TR2: -0.3605 | VR2: 0.3794
| model_train    | I: 0 | E: 7 | TD: 50 | VD: 0 | MLOSS: 2.7631 | MVSCORE: 2.4367 | MBVSCORE: 2.4367 | TR2: -0.3057 | VR2: 0.3943
| model_train    | I: 0 | E: 8 | TD: 50 | VD: 0 | MLOSS: 2.6980 | MVSCORE: 2.3739 | MBVSCORE: 2.3739 | TR2: -0.2574 | VR2: 0.4093
| model_train    | I: 0 | E: 9 | TD: 50 | VD: 0 | MLOSS: 2.6374 | MVSCORE: 2.3105 | MBVSCORE: 2.3105 | TR2: -0.2146 | VR2: 0.4244
wandb: 429 encountered (Filestream rate limit exceeded, retrying in 2.1 seconds.), retrying request
wandb: 429 encountered (Filestream rate limit exceeded, retrying in 4.4 seconds.), retrying request
wandb: 429 encountered (Filestream rate limit exceeded, retrying in 2.3 seconds.), retrying request
| results        | T: 1 | S: 4 | R: 0.0000
Traceback (most recent call last):
  File "/cluster/home/tvannier/HUCRL_for_FMDP/run_scripts/train.py", line 35, in run
    return pets_adapted.train(env, term_fn, reward_fn, cfg)
  File "/cluster/home/tvannier/HUCRL_for_FMDP/src/algorithm/pets_adapted.py", line 216, in train
    logger.log_data(
  File "/cluster/home/tvannier/.local/lib/python3.9/site-packages/mbrl/util/logger.py", line 186, in log_data
    self._dump(group_name)
  File "/cluster/home/tvannier/.local/lib/python3.9/site-packages/mbrl/util/logger.py", line 192, in _dump
    meter_group.dump(self._group_steps[group_name], group_name, save, color=color)
  File "/cluster/home/tvannier/.local/lib/python3.9/site-packages/mbrl/util/logger.py", line 99, in dump
    self._dump_to_csv(data)
  File "/cluster/home/tvannier/.local/lib/python3.9/site-packages/mbrl/util/logger.py", line 71, in _dump_to_csv
    self._csv_file.flush()
OSError: [Errno 116] Stale file handle
Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.